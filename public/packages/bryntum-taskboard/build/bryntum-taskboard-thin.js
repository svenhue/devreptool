var $jscomp={};$jscomp.scope={};$jscomp.defineProperty=typeof Object.defineProperties=='function'?Object.defineProperty:function(b,c,a){a=(a);if(a.get||a.set){throw new TypeError('ES3 does not support getters and setters.')}if(b==Array.prototype||b==Object.prototype){return}b[c]=a.value};$jscomp.getGlobal=function(a){return typeof window!='undefined'&&window===a?a:typeof global!='undefined'&&global!=null?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(i,f,j,k){if(!f){return}var a=$jscomp.global;var b=i.split('.');for(var e=0;e<b.length-1;e++){var d=b[e];if(!(d in a)){a[d]={}}a=a[d]}var g=b[b.length-1];var h=a[g];var c=f(h);if(c==h||c==null){return}$jscomp.defineProperty(a,g,{configurable:!0,writable:!0,value:c})};$jscomp.polyfill('Array.prototype.copyWithin',function(a){if(a){return a}var b=function(c,b,a){var d=this.length;c=Number(c);b=Number(b);a=Number(a!=null?a:d);if(c<b){a=Math.min(a,d);while(b<a){if(b in this){this[c++]=this[b++]}else {delete this[c++];b++}}}else {a=Math.min(a,d+b-c);c+=a-b;while(a>b){if(--a in this){this[--c]=this[a]}else {delete this[c]}}}return this};return b},'es6-impl','es3');$jscomp.SYMBOL_PREFIX='jscomp_symbol_';$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};if(!$jscomp.global.Symbol){$jscomp.global.Symbol=$jscomp.Symbol}};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return ($jscomp.SYMBOL_PREFIX+(a||'')+$jscomp.symbolCounter_++)};$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;if(!a){a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol('iterator')}if(typeof Array.prototype[a]!='function'){$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}})}$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var b=0;return $jscomp.iteratorPrototype(function(){if(b<a.length){return {done:!1,value:a[b++]}}else {return {done:!0}}})};$jscomp.iteratorPrototype=function(b){$jscomp.initSymbolIterator();var a={next:b};a[$jscomp.global.Symbol.iterator]=function(){return this};return (a)};$jscomp.array=$jscomp.array||{};$jscomp.iteratorFromArray=function(a,d){$jscomp.initSymbolIterator();if(a instanceof String){a=a+''}var c=0;var b={next:function(){if(c<a.length){var e=c++;return {value:d(e,a[e]),done:!1}}b.next=function(){return {done:!0,value:void 0}};return b.next()}};b[Symbol.iterator]=function(){return b};return b};$jscomp.polyfill('Array.prototype.entries',function(a){if(a){return a}var b=function(){return $jscomp.iteratorFromArray(this,function(a,b){return [a,b]})};return b},'es6-impl','es3');$jscomp.polyfill('Array.prototype.fill',function(a){if(a){return a}var b=function(e,b,a){var c=this.length||0;if(b<0){b=Math.max(0,c+(b))}if(a==null||a>c){a=c}a=Number(a);if(a<0){a=Math.max(0,c+a)}for(var d=Number(b||0);d<a;d++){this[d]=e}return this};return b},'es6-impl','es3');$jscomp.findInternal=function(a,d,e){if(a instanceof String){a=(String(a))}var f=a.length;for(var b=0;b<f;b++){var c=a[b];if(d.call(e,c,b,a)){return {i:b,v:c}}}return {i:-1,v:void 0}};$jscomp.polyfill('Array.prototype.find',function(a){if(a){return a}var b=function(b,a){return $jscomp.findInternal(this,b,a).v};return b},'es6-impl','es3');$jscomp.polyfill('Array.prototype.findIndex',function(a){if(a){return a}var b=function(b,a){return $jscomp.findInternal(this,b,a).i};return b},'es6-impl','es3');$jscomp.polyfill('Array.from',function(a){if(a){return a}var b=function(a,b,f){$jscomp.initSymbolIterator();b=b!=null?b:function(a){return a};var c=[];var e=(a)[Symbol.iterator];if(typeof e=='function'){a=e.call(a);var g;while(!(g=a.next()).done){c.push(b.call((f),g.value))}}else {var h=a.length;for(var d=0;d<h;d++){c.push(b.call((f),a[d]))}}return c};return b},'es6-impl','es3');$jscomp.polyfill('Array.prototype.keys',function(a){if(a){return a}var b=function(){return $jscomp.iteratorFromArray(this,function(a){return a})};return b},'es6-impl','es3');$jscomp.polyfill('Array.of',function(a){if(a){return a}var b=function(a){return Array.from(arguments)};return b},'es6-impl','es3');$jscomp.polyfill('Array.prototype.values',function(a){if(a){return a}var b=function(){return $jscomp.iteratorFromArray(this,function(b,a){return a})};return b},'es6','es3');$jscomp.executeAsyncGenerator=function(a){function passValueToGenerator(b){return a.next(b)}function passErrorToGenerator(b){return a['throw'](b)}return new Promise(function(b,c){function handleGeneratorRecord(a){if(a.done){b(a.value)}else {Promise.resolve(a.value).then(passValueToGenerator,passErrorToGenerator).then(handleGeneratorRecord,c)}}handleGeneratorRecord(a.next())})};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();var b=(a)[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator((a))};$jscomp.owns=function(b,a){return Object.prototype.hasOwnProperty.call(b,a)};$jscomp.polyfill('WeakMap',function(c){function isConformant(){if(!c||!Object.seal){return !1}try{var b=Object.seal({});var d=Object.seal({});var a=new (c)([[b,2],[d,3]]);if(a.get(b)!=2||a.get(d)!=3){return !1}a['delete'](b);a.set(d,4);return !a.has(b)&&a.get(d)==4}catch(e){return !1}}if(isConformant()){return c}var a='$jscomp_hidden_'+Math.random().toString().substring(2);function insert(b){if(!$jscomp.owns(b,a)){var c={};$jscomp.defineProperty(b,a,{value:c})}}function patch(a){var b=Object[a];if(b){Object[a]=function(a){insert(a);return b(a)}}}patch('freeze');patch('preventExtensions');patch('seal');var d=0;var b=function(a){this.id_=(d+=Math.random()+1).toString();if(a){$jscomp.initSymbol();$jscomp.initSymbolIterator();var e=$jscomp.makeIterator(a);var b;while(!(b=e.next()).done){var c=b.value;this.set((c[0]),(c[1]))}}};b.prototype.set=function(b,c){insert(b);if(!$jscomp.owns(b,a)){throw new Error('WeakMap key fail: '+b)}b[a][this.id_]=c;return this};b.prototype.get=function(b){return $jscomp.owns(b,a)?b[a][this.id_]:undefined};b.prototype.has=function(b){return $jscomp.owns(b,a)&&$jscomp.owns(b[a],this.id_)};b.prototype['delete']=function(b){if(!$jscomp.owns(b,a)||!$jscomp.owns(b[a],this.id_)){return !1}return delete b[a][this.id_]};return b},'es6-impl','es3');$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.polyfill('Map',function(b){var h=!$jscomp.ASSUME_NO_NATIVE_MAP&&function(){if(!b||!b.prototype.entries||typeof Object.seal!='function'){return !1}try{b=(b);var e=Object.seal({x:4});var c=new b($jscomp.makeIterator([[e,'s']]));if(c.get(e)!='s'||c.size!=1||c.get({x:4})||c.set({x:4},'t')!=c||c.size!=2){return !1}var d=c.entries();var a=d.next();if(a.done||a.value[0]!=e||a.value[1]!='s'){return !1}a=d.next();if(a.done||a.value[0].x!=4||a.value[1]!='t'||!d.next().done){return !1}return !0}catch(k){return !1}}();if(h){return b}$jscomp.initSymbol();$jscomp.initSymbolIterator();var f=new WeakMap();var c=function(){};c.prototype.previous;c.prototype.next;c.prototype.head;c.prototype.key;c.prototype.value;var a=function(a){this.data_={};this.head_=g();this.size=0;if(a){var d=$jscomp.makeIterator(a);var b;while(!(b=d.next()).done){var c=(b).value;this.set((c[0]),(c[1]))}}};a.prototype.set=function(c,b){var a=d(this,c);if(!a.list){a.list=this.data_[a.id]=[]}if(!a.entry){a.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:c,value:b};a.list.push(a.entry);this.head_.previous.next=a.entry;this.head_.previous=a.entry;this.size++}else {a.entry.value=b}return this};a.prototype['delete']=function(b){var a=d(this,b);if(a.entry&&a.list){a.list.splice(a.index,1);if(!a.list.length){delete this.data_[a.id]}a.entry.previous.next=a.entry.next;a.entry.next.previous=a.entry.previous;a.entry.head=null;this.size--;return !0}return !1};a.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=g();this.size=0};a.prototype.has=function(a){return !!d(this,a).entry};a.prototype.get=function(b){var a=d(this,b).entry;return (a&&(a.value))};a.prototype.entries=function(){return e(this,function(a){return [a.key,a.value]})};a.prototype.keys=function(){return e(this,function(a){return a.key})};a.prototype.values=function(){return e(this,function(a){return a.value})};a.prototype.forEach=function(d,c){var e=this.entries();var b;while(!(b=e.next()).done){var a=b.value;d.call((c),(a[1]),(a[0]),this)}};(a.prototype)[Symbol.iterator]=a.prototype.entries;var d=function(f,d){var e=j(d);var a=f.data_[e];if(a&&$jscomp.owns(f.data_,e)){for(var c=0;c<a.length;c++){var b=a[c];if(d!==d&&b.key!==b.key||d===b.key){return {id:e,list:a,index:c,entry:b}}}}return {id:e,list:a,index:-1,entry:undefined}};var e=function(b,c){var a=b.head_;return $jscomp.iteratorPrototype(function(){if(a){while(a.head!=b.head_){a=a.previous}while(a.next!=a.head){a=a.next;return {done:!1,value:c(a)}}a=null}return {done:!0,value:void 0}})};var g=function(){var a={};a.previous=a.next=a.head=a;return a};var i=0;var j=function(a){var b=a&&typeof a;if(b=='object'||b=='function'){a=(a);if(!f.has(a)){var c=''+ ++i;f.set(a,c);return c}return f.get(a)}return 'p_'+a};return a},'es6-impl','es3');$jscomp.polyfill('Math.acosh',function(a){if(a){return a}var b=function(a){a=Number(a);return Math.log(a+Math.sqrt(a*a-1))};return b},'es6-impl','es3');$jscomp.polyfill('Math.asinh',function(a){if(a){return a}var b=function(a){a=Number(a);if(a===0){return a}var b=Math.log(Math.abs(a)+Math.sqrt(a*a+1));return a<0?-b:b};return b},'es6-impl','es3');$jscomp.polyfill('Math.log1p',function(a){if(a){return a}var b=function(a){a=Number(a);if(a<0.25&&a>-0.25){var e=a;var f=1;var b=a;var c=0;var d=1;while(c!=b){e*=a;d*=-1;b=(c=b)+d*e/++f}return b}return Math.log(1+a)};return b},'es6-impl','es3');$jscomp.polyfill('Math.atanh',function(b){if(b){return b}var a=Math.log1p;var c=function(b){b=Number(b);return (a(b)-a(-b))/2};return c},'es6-impl','es3');$jscomp.polyfill('Math.cbrt',function(a){if(a){return a}var b=function(a){if(a===0){return a}a=Number(a);var b=Math.pow(Math.abs(a),1/3);return a<0?-b:b};return b},'es6-impl','es3');$jscomp.polyfill('Math.clz32',function(a){if(a){return a}var b=function(a){a=Number(a)>>>0;if(a===0){return 32}var b=0;if((a&4.29490176E9)===0){a<<=16;b+=16}if((a&4.27819008E9)===0){a<<=8;b+=8}if((a&4.02653184E9)===0){a<<=4;b+=4}if((a&3.221225472E9)===0){a<<=2;b+=2}if((a&2.147483648E9)===0){b++}return b};return b},'es6-impl','es3');$jscomp.polyfill('Math.cosh',function(a){if(a){return a}var b=Math.exp;var c=function(a){a=Number(a);return (b(a)+b(-a))/2};return c},'es6-impl','es3');$jscomp.polyfill('Math.expm1',function(a){if(a){return a}var b=function(a){a=Number(a);if(a<0.25&&a>-0.25){var d=a;var e=1;var b=a;var c=0;while(c!=b){d*=a/++e;b=(c=b)+d}return b}return Math.exp(a)-1};return b},'es6-impl','es3');$jscomp.polyfill('Math.hypot',function(a){if(a){return a}var b=function(b,c,g){b=Number(b);c=Number(c);var a,f,e;var d=Math.max(Math.abs(b),Math.abs(c));for(a=2;a<arguments.length;a++){d=Math.max(d,Math.abs(arguments[a]))}if(d>1.0E100||d<1.0E-100){b=b/d;c=c/d;e=b*b+c*c;for(a=2;a<arguments.length;a++){f=Number(arguments[a])/d;e+=f*f}return Math.sqrt(e)*d}else {e=b*b+c*c;for(a=2;a<arguments.length;a++){f=Number(arguments[a]);e+=f*f}return Math.sqrt(e)}};return b},'es6-impl','es3');$jscomp.polyfill('Math.imul',function(a){if(a){return a}var b=function(a,b){a=Number(a);b=Number(b);var e=a>>>16&65535;var c=a&65535;var f=b>>>16&65535;var d=b&65535;var g=e*d+c*f<<16>>>0;return c*d+g|0};return b},'es6-impl','es3');$jscomp.polyfill('Math.log10',function(a){if(a){return a}var b=function(a){return Math.log(a)/Math.LN10};return b},'es6-impl','es3');$jscomp.polyfill('Math.log2',function(a){if(a){return a}var b=function(a){return Math.log(a)/Math.LN2};return b},'es6-impl','es3');$jscomp.polyfill('Math.sign',function(a){if(a){return a}var b=function(a){a=Number(a);return a===0||isNaN(a)?a:a>0?1:-1};return b},'es6-impl','es3');$jscomp.polyfill('Math.sinh',function(a){if(a){return a}var b=Math.exp;var c=function(a){a=Number(a);if(a===0){return a}return (b(a)-b(-a))/2};return c},'es6-impl','es3');$jscomp.polyfill('Math.tanh',function(a){if(a){return a}var b=function(a){a=Number(a);if(a===0){return a}var b=Math.exp(-2*Math.abs(a));var c=(1-b)/(1+b);return a<0?-c:c};return b},'es6-impl','es3');$jscomp.polyfill('Math.trunc',function(a){if(a){return a}var b=function(a){a=Number(a);if(isNaN(a)||a===Infinity||a===-Infinity||a===0){return a}var b=Math.floor(Math.abs(a));return a<0?-b:b};return b},'es6-impl','es3');$jscomp.polyfill('Number.EPSILON',function(a){return Math.pow(2,-52)},'es6-impl','es3');$jscomp.polyfill('Number.MAX_SAFE_INTEGER',function(){return 9.007199254740991E15},'es6-impl','es3');$jscomp.polyfill('Number.MIN_SAFE_INTEGER',function(){return -9.007199254740991E15},'es6-impl','es3');$jscomp.polyfill('Number.isFinite',function(a){if(a){return a}var b=function(a){if(typeof a!=='number'){return !1}return !isNaN(a)&&a!==Infinity&&a!==-Infinity};return b},'es6-impl','es3');$jscomp.polyfill('Number.isInteger',function(a){if(a){return a}var b=function(a){if(!Number.isFinite(a)){return !1}return a===Math.floor(a)};return b},'es6-impl','es3');$jscomp.polyfill('Number.isNaN',function(a){if(a){return a}var b=function(a){return typeof a==='number'&&isNaN(a)};return b},'es6-impl','es3');$jscomp.polyfill('Number.isSafeInteger',function(a){if(a){return a}var b=function(a){return Number.isInteger(a)&&Math.abs(a)<=Number.MAX_SAFE_INTEGER};return b},'es6-impl','es3');$jscomp.polyfill('Object.assign',function(a){if(a){return a}var b=function(d,e){for(var c=1;c<arguments.length;c++){var a=arguments[c];if(!a){continue}for(var b in a){if($jscomp.owns(a,b)){d[b]=a[b]}}}return d};return b},'es6-impl','es3');$jscomp.polyfill('Object.getOwnPropertySymbols',function(a){if(a){return a}return function(){return []}},'es6-impl','es5');$jscomp.polyfill('Object.is',function(a){if(a){return a}var b=function(a,b){if(a===b){return a!==0||1/a===1/(b)}else {return a!==a&&b!==b}};return b},'es6-impl','es3');$jscomp.polyfill('Object.setPrototypeOf',function(a){if(a){return a}if(typeof ''.__proto__!='object'){return null}var b=function(a,b){a.__proto__=b;if(a.__proto__!==b){throw new TypeError(a+' is not extensible')}return a};return b},'es6','es5');$jscomp.EXPOSE_ASYNC_EXECUTOR=!0;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.polyfill('Promise',function(c){if(c&&!$jscomp.FORCE_POLYFILL_PROMISE){return c}function AsyncExecutor(){this.batch_=null}AsyncExecutor.prototype.asyncExecute=function(a){if(this.batch_==null){this.batch_=[];this.asyncExecuteBatch_()}this.batch_.push(a);return this};AsyncExecutor.prototype.asyncExecuteBatch_=function(){var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})};var e=$jscomp.global['setTimeout'];AsyncExecutor.prototype.asyncExecuteFunction=function(a){e(a,0)};AsyncExecutor.prototype.executeBatch_=function(){while(this.batch_&&this.batch_.length){var b=this.batch_;this.batch_=[];for(var a=0;a<b.length;++a){var c=b[a];delete b[a];try{c()}catch(f){this.asyncThrow_(f)}}}this.batch_=null};AsyncExecutor.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a})};var b={PENDING:0,FULFILLED:1,REJECTED:2};var a=function(c){this.state_=b.PENDING;this.result_=undefined;this.onSettledCallbacks_=[];var a=this.createResolveAndReject_();try{c(a.resolve,a.reject)}catch(f){a.reject(f)}};a.prototype.createResolveAndReject_=function(){var b=this;var a=!1;function firstCallWins(c){return function(d){if(!a){a=!0;c.call(b,d)}}}return {resolve:firstCallWins(this.resolveTo_),reject:firstCallWins(this.reject_)}};a.prototype.resolveTo_=function(b){if(b===this){this.reject_(new TypeError('A Promise cannot resolve to itself'))}else {if(b instanceof a){this.settleSameAsPromise_((b))}else {if(isObject(b)){this.resolveToNonPromiseObj_((b))}else {this.fulfill_(b)}}}};a.prototype.resolveToNonPromiseObj_=function(b){var a=undefined;try{a=b.then}catch(f){this.reject_(f);return}if(typeof a=='function'){this.settleSameAsThenable_(a,(b))}else {this.fulfill_(b)}};function isObject(a){switch(typeof a){case 'object':return a!=null;case 'function':return !0;default:return !1;}}a.prototype.reject_=function(a){this.settle_(b.REJECTED,a)};a.prototype.fulfill_=function(a){this.settle_(b.FULFILLED,a)};a.prototype.settle_=function(c,a){if(this.state_!=b.PENDING){throw new Error('Cannot settle('+c+', '+a|'): Promise already settled in state'+this.state_)}this.state_=c;this.result_=a;this.executeOnSettledCallbacks_()};a.prototype.executeOnSettledCallbacks_=function(){if(this.onSettledCallbacks_!=null){var b=this.onSettledCallbacks_;for(var a=0;a<b.length;++a){(b[a]).call();b[a]=null}this.onSettledCallbacks_=null}};var d=new AsyncExecutor();a.prototype.settleSameAsPromise_=function(b){var a=this.createResolveAndReject_();b.callWhenSettled_(a.resolve,a.reject)};a.prototype.settleSameAsThenable_=function(b,c){var a=this.createResolveAndReject_();try{b.call(c,a.resolve,a.reject)}catch(f){a.reject(f)}};a.prototype.then=function(e,f){var b;var c;var d=new a(function(a,d){b=a;c=d});function createCallback(a,d){if(typeof a=='function'){return function(d){try{b(a(d))}catch(g){c(g)}}}else {return d}}this.callWhenSettled_(createCallback(e,b),createCallback(f,c));return d};a.prototype['catch']=function(a){return this.then(undefined,a)};a.prototype.callWhenSettled_=function(c,e){var a=this;function callback(){switch(a.state_){case b.FULFILLED:c(a.result_);break;case b.REJECTED:e(a.result_);break;default:throw new Error('Unexpected state: '+a.state_);}}if(this.onSettledCallbacks_==null){d.asyncExecute(callback)}else {this.onSettledCallbacks_.push(function(){d.asyncExecute(callback)})}};a.resolve=function(b){if(b instanceof a){return b}else {return new a(function(a,c){a(b)})}};a.reject=function(b){return new a(function(c,a){a(b)})};a.race=function(b){return new a(function(e,f){var d=$jscomp.makeIterator(b);for(var c=d.next();!c.done;c=d.next()){a.resolve(c.value).callWhenSettled_(e,f)}})};a.all=function(d){var c=$jscomp.makeIterator(d);var b=c.next();if(b.done){return a.resolve([])}else {return new a(function(f,g){var d=[];var e=0;function onFulfilled(a){return function(b){d[a]=b;e--;if(e==0){f(d)}}}do{d.push(undefined);e++;a.resolve(b.value).callWhenSettled_(onFulfilled(d.length-1),g);b=c.next()}while(!b.done)})}};if($jscomp.EXPOSE_ASYNC_EXECUTOR){a['$jscomp$new$AsyncExecutor']=function(){return new AsyncExecutor()}}return a},'es6-impl','es3');$jscomp.polyfill('Reflect.apply',function(a){if(a){return a}var c=Function.prototype.apply;var b=function(d,b,a){return c.call(d,b,a)};return b},'es6','es3');$jscomp.polyfill('Reflect.construct',function(a){if(a){return a}var b=function(b,d,a){if(a===undefined){a=b}var e=a.prototype||Object.prototype;var c=Object.create(e);var f=Reflect.apply(b,c,d);return f||c};return b},'es6','es5');$jscomp.polyfill('Reflect.defineProperty',function(a){if(a){return a}var b=function(d,c,b){try{Object.defineProperty(d,c,b);var a=Object.getOwnPropertyDescriptor(d,c);if(!a){return !1}return a.configurable===(b.configurable||!1)&&a.enumerable===(b.enumerable||!1)&&('value' in a?a.value===b.value&&a.writable===(b.writable||!1):a.get===b.get&&a.set===b.set)}catch(e){return !1}};return b},'es6','es5');$jscomp.polyfill('Reflect.deleteProperty',function(a){if(a){return a}var b=function(b,a){if(!$jscomp.owns(b,a)){return !0}try{return delete b[a]}catch(c){return !1}};return b},'es6','es3');$jscomp.polyfill('Reflect.getOwnPropertyDescriptor',function(a){return a||Object.getOwnPropertyDescriptor},'es6','es5');$jscomp.polyfill('Reflect.getPrototypeOf',function(a){return a||Object.getPrototypeOf},'es6','es5');$jscomp.findDescriptor=function(d,c){var a=d;while(a){var b=Reflect.getOwnPropertyDescriptor(a,c);if(b){return b}a=Reflect.getPrototypeOf(a)}return undefined};$jscomp.polyfill('Reflect.get',function(a){if(a){return a}var b=function(c,b,d){if(arguments.length<=2){return c[b]}var a=$jscomp.findDescriptor(c,b);if(a){return a.get?a.get.call(d):a.value}return undefined};return b},'es6','es5');$jscomp.polyfill('Reflect.has',function(a){if(a){return a}var b=function(b,a){return a in b};return b},'es6','es3');$jscomp.polyfill('Reflect.isExtensible',function(a){if(a){return a}if(typeof Object.isExtensible=='function'){return Object.isExtensible}return function(){return !0}},'es6','es3');$jscomp.polyfill('Reflect.ownKeys',function(b){if(b){return b}var a='jscomp_symbol_';function isSymbol(b){return b.substring(0,a.length)==a}var c=function(d){var e=[];var b=Object.getOwnPropertyNames(d);var c=Object.getOwnPropertySymbols(d);for(var a=0;a<b.length;a++){(isSymbol(b[a])?c:e).push(b[a])}return e.concat(c)};return c},'es6','es5');$jscomp.polyfill('Reflect.preventExtensions',function(a){if(a){return a}if(typeof Object.preventExtensions!='function'){return function(){return !1}}var b=function(a){Object.preventExtensions(a);return !Object.isExtensible(a)};return b},'es6','es3');$jscomp.polyfill('Reflect.set',function(a){if(a){return a}var b=function(a,c,d,e){var b=$jscomp.findDescriptor(a,c);if(!b){if(Reflect.isExtensible(a)){a[c]=d;return !0}return !1}if(b.set){b.set.call(arguments.length>3?e:a,d);return !0}else {if(b.writable&&!Object.isFrozen(a)){a[c]=d;return !0}}return !1};return b},'es6','es5');$jscomp.polyfill('Reflect.setPrototypeOf',function(a){if(a){return a}if(typeof ''.__proto__!='object'){return null}var b=function(a,b){try{a.__proto__=b;return a.__proto__===b}catch(c){return !1}};return b},'es6','es5');$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.polyfill('Set',function(b){var c=!$jscomp.ASSUME_NO_NATIVE_SET&&function(){if(!b||!b.prototype.entries||typeof Object.seal!='function'){return !1}try{b=(b);var d=Object.seal({x:4});var c=new b($jscomp.makeIterator([d]));if(!c.has(d)||c.size!=1||c.add(d)!=c||c.size!=1||c.add({x:4})!=c||c.size!=2){return !1}var e=c.entries();var a=e.next();if(a.done||a.value[0]!=d||a.value[1]!=d){return !1}a=e.next();if(a.done||a.value[0]==d||a.value[0].x!=4||a.value[1]!=a.value[0]){return !1}return e.next().done}catch(f){return !1}}();if(c){return b}$jscomp.initSymbol();$jscomp.initSymbolIterator();var a=function(a){this.map_=new Map();if(a){var d=$jscomp.makeIterator(a);var b;while(!(b=d.next()).done){var c=(b).value;this.add(c)}}this.size=this.map_.size};a.prototype.add=function(a){this.map_.set(a,a);this.size=this.map_.size;return this};a.prototype['delete']=function(b){var a=this.map_['delete'](b);this.size=this.map_.size;return a};a.prototype.clear=function(){this.map_.clear();this.size=0};a.prototype.has=function(a){return this.map_.has(a)};a.prototype.entries=function(){return this.map_.entries()};a.prototype.values=function(){return this.map_.values()};(a.prototype)[Symbol.iterator]=a.prototype.values;a.prototype.forEach=function(b,a){var c=this;this.map_.forEach(function(d){return b.call((a),d,d,c)})};return a},'es6-impl','es3');$jscomp.checkStringArgs=function(a,c,b){if(a==null){throw new TypeError("The 'this' value for String.prototype."+b+' must not be null or undefined')}if(c instanceof RegExp){throw new TypeError('First argument to String.prototype.'+b+' must not be a regular expression')}return a+''};$jscomp.polyfill('String.prototype.codePointAt',function(a){if(a){return a}var b=function(a){var d=$jscomp.checkStringArgs(this,null,'codePointAt');var e=d.length;a=Number(a)||0;if(!(a>=0&&a<e)){return void 0}a=a|0;var b=d.charCodeAt(a);if(b<55296||b>56319||a+1===e){return b}var c=d.charCodeAt(a+1);if(c<56320||c>57343){return b}return (b-55296)*1024+c+9216};return b},'es6-impl','es3');$jscomp.polyfill('String.prototype.endsWith',function(a){if(a){return a}var b=function(a,b){var c=$jscomp.checkStringArgs(this,a,'endsWith');a=a+'';if(b===void 0){b=c.length}var e=Math.max(0,Math.min(b|0,c.length));var d=a.length;while(d>0&&e>0){if(c[--e]!=a[--d]){return !1}}return d<=0};return b},'es6-impl','es3');$jscomp.polyfill('String.fromCodePoint',function(a){if(a){return a}var b=function(d){var b='';for(var c=0;c<arguments.length;c++){var a=Number(arguments[c]);if(a<0||a>1114111||a!==Math.floor(a)){throw new RangeError('invalid_code_point '+a)}if(a<=65535){b+=String.fromCharCode(a)}else {a-=65536;b+=String.fromCharCode(a>>>10&1023|55296);b+=String.fromCharCode(a&1023|56320)}}return b};return b},'es6-impl','es3');$jscomp.polyfill('String.prototype.includes',function(a){if(a){return a}var b=function(a,b){var c=$jscomp.checkStringArgs(this,a,'includes');return c.indexOf(a,b||0)!==-1};return b},'es6-impl','es3');$jscomp.polyfill('String.prototype.repeat',function(a){if(a){return a}var b=function(a){var b=$jscomp.checkStringArgs(this,null,'repeat');if(a<0||a>1342177279){throw new RangeError('Invalid count value')}a=a|0;var c='';while(a){if(a&1){c+=b}if(a>>>=1){b+=b}}return c};return b},'es6-impl','es3');$jscomp.polyfill('String.prototype.startsWith',function(a){if(a){return a}var b=function(a,f){var b=$jscomp.checkStringArgs(this,a,'startsWith');a=a+'';var g=b.length;var d=a.length;var e=Math.max(0,Math.min((f)|0,b.length));var c=0;while(c<d&&e<g){if(b[e++]!=a[c++]){return !1}}return c>=d};return b},'es6-impl','es3');$jscomp.arrayFromIterator=function(c){var b;var a=[];while(!(b=c.next()).done){a.push(b.value)}return a};$jscomp.arrayFromIterable=function(a){if(a instanceof Array){return a}else {return $jscomp.arrayFromIterator($jscomp.makeIterator(a))}};$jscomp.inherits=function(a,b){function tempCtor(){}tempCtor.prototype=b.prototype;a.prototype=new tempCtor();a.prototype.constructor=a;for(var c in b){if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);if(d){Object.defineProperty(a,c,d)}}else {a[c]=b[c]}}};$jscomp.polyfill('WeakSet',function(b){function isConformant(){if(!b||!Object.seal){return !1}try{var c=Object.seal({});var d=Object.seal({});var a=new (b)([c]);if(!a.has(c)||a.has(d)){return !1}a['delete'](c);a.add(d);return !a.has(c)&&a.has(d)}catch(e){return !1}}if(isConformant()){return b}var a=function(a){this.map_=new WeakMap();if(a){$jscomp.initSymbol();$jscomp.initSymbolIterator();var d=$jscomp.makeIterator(a);var b;while(!(b=d.next()).done){var c=b.value;this.add(c)}}};a.prototype.add=function(a){this.map_.set(a,!0);return this};a.prototype.has=function(a){return this.map_.has(a)};a.prototype['delete']=function(a){return this.map_['delete'](a)};return a},'es6-impl','es3');try{if(Array.prototype.values.toString().indexOf('[native code]')==-1){delete Array.prototype.values}}catch(a){}Ext.define('Kanban.patch.EXTJS_23846',{extend:'Sch.util.Patch',requires:['Ext.dom.Element','Ext.event.publisher.Gesture'],target:['Ext.dom.Element','Ext.event.publisher.Gesture'],maxVersion:'6.2.2',applyFn:function(){if(Ext.firefoxVersion<51){return}if(!Ext.ClassManager.isCreated('EXTJS_23846.Element')){Ext.define('EXTJS_23846.Element',{override:'Ext.dom.Element'},function(e){var c=Ext.supports,d=e.prototype,b=d.eventMap,a=d.additiveEvents;if(Ext.os.is.Desktop&&c.TouchEvents&&!c.PointerEvents){b.touchstart='mousedown';b.touchmove='mousemove';b.touchend='mouseup';b.touchcancel='mouseup';a.mousedown='mousedown';a.mousemove='mousemove';a.mouseup='mouseup';a.touchstart='touchstart';a.touchmove='touchmove';a.touchend='touchend';a.touchcancel='touchcancel';a.pointerdown='mousedown';a.pointermove='mousemove';a.pointerup='mouseup';a.pointercancel='mouseup'}})}if(!Ext.ClassManager.isCreated('EXTJS_23846.Gesture')){Ext.define('EXTJS_23846.Gesture',{override:'Ext.event.publisher.Gesture'},function(b){var a=b.instance;if(Ext.supports.TouchEvents&&!Ext.isWebKit&&Ext.os.is.Desktop){a.handledDomEvents.push('mousedown','mousemove','mouseup');a.registerEvents()}})}}});Ext.define('Kanban.model.Resource',{extend:'Sch.model.Resource',alias:'model.kanban_resourcemodel',customizableFields:[{name:'ImageUrl'}],imageUrlField:'ImageUrl'});Ext.define('Kanban.data.ResourceStore',{extend:'Sch.data.ResourceStore',model:'Kanban.model.Resource',sorters:'Name',proxy:undefined,alias:'store.kanban_resourcestore'});Ext.define('Kanban.model.Task',{extend:'Sch.model.Event',alias:'model.kanban_taskmodel',resourceStore:null,states:['NotStarted','InProgress','Test','Done'],customizableFields:[{name:'State',defaultValue:'NotStarted'},{name:'Position',type:'int'},{name:'CreatedDate',type:'date'},{name:'ImageUrl'}],constructor:function(){this.callParent(arguments);if(this.phantom&&!this.getCreatedDate()){this.setCreatedDate(new Date())}},stateField:'State',imageUrlField:'ImageUrl',createdDateField:'CreatedDate',positionField:'Position',getResourceStore:function(){if(!this.resourceStore){Ext.Array.each(this.joined,function(a){if(a.resourceStore){this.resourceStore=a.resourceStore;return !1}},this)}return this.resourceStore},isValidTransition:function(a){var b=this.getState();if(b===a){return !0}switch(this.getState()){case 'NotStarted':return a=='InProgress';case 'InProgress':return a!='Done';case 'Test':return a!='NotStarted';case 'Done':return a=='Test'||a=='InProgress';default:return !0;}}});Ext.define('Kanban.data.TaskStore',{extend:'Sch.data.EventStore',model:'Kanban.model.Task',proxy:undefined,alias:'store.kanban_taskstore',resourceStore:null,setResourceStore:function(a){this.resourceStore=Ext.data.StoreManager.lookup(a)},getResourceStore:function(){return this.resourceStore},constructor:function(){this.callParent(arguments);var a=this.getModel();this.setSorters([{property:a.prototype.positionField,direction:'ASC'},{property:a.prototype.nameField,direction:'ASC'}])}});Ext.define('Kanban.data.mixin.StoreView',{state:null,masterStore:null,getStoreListeners:function(){return {add:this.onMasterAdd,clear:this.onMasterClear,remove:this.onMasterRemove,update:this.onMasterUpdate,refresh:this.onMasterDataChanged,scope:this}},unbindFromStore:function(){this.masterStore.un(this.getStoreListeners())},bindToStore:function(a){var b=this.getStoreListeners();if(this.masterStore){this.masterStore.un(b)}this.masterStore=a;if(a){a.on(b);this.copyStoreContent()}},onMasterAdd:function(c,b){for(var a=0;a<b.length;a++){if(b[a].getState()===this.state){this.add(b[a])}}},onMasterClear:function(){this.removeAll()},onMasterUpdate:function(c,a,d,b){if(b&&Ext.Array.indexOf(b,c.model.prototype.stateField)>=0){if(this.state===a.getState()){this.add(a)}if(this.state===a.previous[a.stateField]){this.remove(a)}}},onMasterRemove:function(b,a){Ext.Array.each(a,function(a){if(a.getState()===this.state){this.remove(a)}},this)},onMasterDataChanged:function(a){this.copyStoreContent()},copyStoreContent:function(){var b=this.state;var a=[];this.masterStore.each(function(c){if(c.getState()===b){a[a.length]=c}});this.suspendEvents();this.loadData(a);this.resumeEvents();this.sort(this.masterStore.getSorters().items);this.sorters.removeAll()}});Ext.define('Kanban.data.ViewStore',{extend:'Ext.data.Store',mixins:['Kanban.data.mixin.StoreView'],proxy:'memory',masterStore:null,state:null,constructor:function(a){Ext.apply(this,a);if(this.state===null||this.state===undefined){throw 'Must supply state'}if(this.masterStore){var b=this.masterStore=Ext.StoreMgr.lookup(this.masterStore);this.model=b.model}else {throw 'Must supply a master store'}this.callParent(arguments);if(this.masterStore){this.bindToStore(this.masterStore)}},getResourceStore:function(){return this.masterStore.getResourceStore()}});Ext.define('Kanban.dd.DragZone',{extend:'Ext.dd.DragZone',mixins:{observable:'Ext.util.Observable'},requires:['Ext.util.Point'],panel:null,repairHighlight:!1,repairHighlightColor:'transparent',containerScroll:!1,autoOffset:function(a,b){this.setDelta(this.dragData.offsets[0],this.dragData.offsets[1])},setVisibilityForSourceEvents:function(a){Ext.each(this.dragData.taskEls,function(b){b[a?'removeCls':'addCls']('sch-hidden')})},constructor:function(a){this.mixins.observable.constructor.call(this,a);this.callParent(arguments);this.proxy.el.child('.x-dd-drag-ghost').removeCls('x-dd-drag-ghost');this.proxy.addCls('sch-task-dd')},getPlaceholderElements:function(d,b){var e=b.taskEls;var a;var g=b.offsets[0];var h=b.offsets[1];var f=d.getHeight();var c=Ext.core.DomHelper.createDom({tag:'div',cls:'sch-dd-wrap-holder'});Ext.Array.each(e,function(b,e){a=b.dom.cloneNode(!0);a.innerHTML='';a.id=Ext.id();a.boundView=b.dom.boundView;var d=Ext.fly(a);d.removeCls('sch-task-selected');d.addCls('sch-task-placeholder');c.appendChild(a);Ext.fly(a).setStyle({width:b.getWidth()+'px',height:b.getHeight()+'px'})});return c},getDragData:function(a){var e=this.panel,g=a.getTarget(e.taskSelector);if(!g||e.isReadOnly()){return}var c=e.resolveRecordByNode(g);if(!c||c.isDraggable()===!1||this.fireEvent('beforetaskdrag',this,c,a)===!1){return null}a.preventDefault();var n=a.getXY(),d=Ext.get(g),l=d.getXY(),h=[n[0]-l[0],n[1]-l[1]],f=Ext.getCmp(d.up('.sch-taskview').id),o=d.getRegion();if(!f.isSelected(g)&&!a.ctrlKey){this.fireEvent('taskdragstarting',this,c,a)}var j=this.getDraggingRecords(c),k=[];Ext.Array.forEach(j,function(b){var a=e.getElementForTask(b);if(a){k.push(a)}});var b={view:f,sourceZoomLevel:f.up('panel').zoomLevel,offsets:h,repairXY:[a.getX()-h[0],a.getY()-h[1]],taskEls:k,bodyScroll:Ext.getBody().getScroll(),taskRecords:j};var m=f.getStore();var i=m.getAt(m.indexOf(c)+1);if(i){b.dropOptions={task:i,type:'before'}}b.ddel=this.getDragElement(d,b);b.placeholder=this.getPlaceholderElements(d,b);this.proxy.el.set({size:this.panel.getZoomLevel()});return b},onStartDrag:function(b,c){var a=this.dragData;Ext.fly(a.placeholder).insertBefore(a.taskEls[0]);Ext.Array.forEach(a.taskEls,function(a){a.addCls('sch-hidden')});this.fireEvent('taskdragstart',this,a.taskRecords)},getDraggingRecords:function(b){var a=this.getRelatedRecords(b);var c=b.store;if(a[0]&&a[0].getState()==b.getState()){a=Ext.Array.sort([b].concat(a),this.positionSorter)}else {a=[b].concat(Ext.Array.sort(a,this.positionSorter))}return a},positionSorter:function(b,c){var a=b.store;return a.indexOf(b)>a.indexOf(c)?1:-1},getRelatedRecords:function(b){var d=this.panel;var c=d.getSelectedRecords();var a=[];Ext.each(c,function(c){if(c.getId()!==b.getId()&&c.isDraggable()!==!1){a.push(c)}});return a},getDragElement:function(c,b){var d=b.taskEls;var a;var i=b.offsets[0];var j=b.offsets[1];var g=this.panel.getElementForTask(b.taskRecords[0]).getHeight();if(d.length>1){var f=Ext.core.DomHelper.createDom({tag:'div',cls:'sch-dd-wrap',style:{overflow:'visible'}});Ext.Array.forEach(d,function(b,c){a=b.dom.cloneNode(!0);a.id='';a.className+=c===0?' sch-dd-source':' sch-dd-extra';var e=b.up('[size]');var d=Ext.core.DomHelper.createDom({tag:'div',size:e.getAttribute('size')}).cloneNode(!0);d.appendChild(a);f.appendChild(d);Ext.fly(a).setStyle({left:(c>0?10:0)+'px',top:(c===0?0:g-30+c*20)+'px',width:b.getWidth()+'px',height:b.getHeight()+'px',position:'absolute'})});return f}else {a=c.dom.cloneNode(!0);a.id='';a.style.width=c.getWidth()+'px';a.style.height=c.getHeight()+'px';var h=c.up('[size]');var e=Ext.core.DomHelper.createDom({tag:'div',size:h.getAttribute('size')}).cloneNode(!0);e.appendChild(a);return e}},getRepairXY:function(b,a){return a.repairXY},afterRepair:function(){this.dragging=!1},onInvalidDrop:function(b,a,d){if(!a){a=b;b=a.getTarget()||document.body}var c=this.callParent([b,a,d]);this.fireEvent('aftertaskdrop',this,this.dragData.taskRecords);if(this.dragData.placeholder){Ext.fly(this.dragData.placeholder).remove()}this.setVisibilityForSourceEvents(!0);return c}});Ext.define('Kanban.dd.DropZone',{extend:'Ext.dd.DropZone',mixins:{observable:'Ext.util.Observable'},constructor:function(a){this.callParent(arguments);this.mixins.observable.constructor.call(this,a)},panel:null,dragData:null,getTargetFromEvent:function(a){return a.getTarget()},validatorFn:Ext.emptyFn,validatorFnScope:null,zoomLevels:['large','medium','small','mini'],shouldDropBeforeNode:function(d,f,c){var a=Ext.fly(f).getBox();var e=c.proxy.getXY();var b;if(this.dropMode==='vertical'){b=(a.bottom-a.top)/2;if(this.direction.up){return e[1]-a.top<b}else {var g=Ext.fly(c.dragData.placeholder.children[0]).getHeight();return e[1]+g-a.top<b}}else {b=(a.right-a.left)/2;if(Ext.Array.indexOf(this.zoomLevels,c.dragData.currentZoomLevel)>Ext.Array.indexOf(this.zoomLevels,c.dragData.sourceZoomLevel)){if(d[1]<a.top){return !0}else {if(d[1]>a.bottom){return !1}}return d[0]-a.left<(a.right-a.left)/2}else {if(d[1]<a.top){return !0}else {if(d[1]>a.bottom){return !1}}if(this.direction.left){return e[0]-a.left<b}else {var h=Ext.fly(c.dragData.placeholder.children[0]).getWidth();return e[0]+h-a.left<b}}}},getDropMode:function(a){var b=Ext.DomQuery.select(a.getItemSelector()+':not(.sch-hidden)',a.el.dom)[0];if(!b){return 'vertical'}if(Ext.fly(b).getWidth()*2<a.getWidth()){return 'horizontal'}return 'vertical'},updatePlaceholderElements:function(b,f){var a;var c=Ext.core.DomHelper.createDom({tag:'div',cls:'sch-dd-wrap-holder'});for(var e=0,g=f.taskRecords.length;e<g;e++){a=b.cloneNode(!0);a.innerHTML='';a.boundView=b.boundView;a.id=Ext.id();var d=Ext.fly(a);d.removeCls('sch-task-selected');d.addCls('sch-task-placeholder');c.appendChild(a);Ext.fly(a).setStyle({width:b.offsetWidth+'px',height:b.offsetHeight+'px'})}return c},getSmallestTask:function(d){var b=Ext.DomQuery.select(d.getItemSelector()+':not(.sch-hidden)',d.el.dom);var a=b[0];for(var c=0;c<b.length;c++){a=a.offsetHeight>b[c].offsetHeight?b[c]:a}return a},getNodeByCoordinate:function(b,a){return document.elementFromPoint(b[0]-a.left,b[1]-a.top)},getTargetView:function(d,e,c){var a=this.getNodeByCoordinate(d,c.bodyScroll);if(a){if(!a.className.match('sch-taskview')){var b=Ext.fly(a).up('.sch-taskview');if(b){a=b.dom}else {a=null}}if(a){return Ext.getCmp(a.id)}}return null},onNodeOver:function(s,j,q,a){var f=q.getXY();this.direction={left:!1,up:!1};var n=this.prevXY;if(n){if(n[0]>f[0]){this.direction.left=!0}else {}if(n[1]>f[1]){this.direction.up=!0}}this.prevXY=f;var o=j.proxy.el.dom;var m=!1;o.style.display='none';var b=this.getTargetView(f,q,a);o.style.display='block';if(!b){return this.dropNotAllowed}if(b){m=a.taskRecords[0].isValidTransition(b.state);if(m){if(b!=a.view){var p=this.getSmallestTask(b);if(p){Ext.fly(a.placeholder).remove();a.placeholder=this.updatePlaceholderElements(p,a)}}if(b!=a.view||!this.dropMode){this.dropMode=this.getDropMode(b);a.currentZoomLevel=b.up('panel').zoomLevel}a.view=b;var k=Ext.get(a.placeholder);var d=b.all.elements.slice(),i=0,e=d.length-1,c,h,g;if(d.length){while(e-i>1){h=Math.floor((i+e)/2);c=d[h];if(Ext.fly(c).isVisible()){g=this.shouldDropBeforeNode(f,c,j);if(g){e=h}else {i=h}}else {d.splice(h,1);e=e-1}}var l=d[i],r=this.shouldDropBeforeNode(f,l,j);if(r){c=l;g=!0}else {if(Ext.fly(d[e]).isVisible()){c=d[e];g=this.shouldDropBeforeNode(f,c,j)}else {c=l;g=!1}}}if(c){if(g){k.insertBefore(c);a.dropOptions={task:b.getRecord(c),type:'before'}}else {k.insertAfter(c);a.dropOptions={task:b.getRecord(c),type:'after'}}}else {b.el.appendChild(k);a.dropOptions=null}}}return m?this.dropAllowed:this.dropNotAllowed},notifyDrop:function(f,g,a){var i=g.getXY();f.proxy.el.dom.style.display='none';var e=this.getTargetView(i,g,a);f.proxy.el.dom.style.display='block';var b=this,c=e&&e.state,h=!0,d=c!==!1&&c!==null;a.newState=c;a.view=e;a.proxy=f.proxy;a.finalize=function(){b.finalize.apply(b,arguments)};d=d&&b.validatorFn.call(b.validatorFnScope||this,a.taskRecords,c)!==!1;this.dragData=a;h=b.fireEvent('beforetaskdropfinalize',b,a,g)!==!1;if(h){return b.finalize(d)}return !0},finalize:function(k){var a=this.dragData,i=a.proxy,c=[];Ext.fly(this.getEl()).select('.sch-dd-wrap-holder').remove();Ext.Array.forEach(a.taskEls,function(a){a.removeCls('sch-hidden')});if(k){var h=a.taskRecords,j=h[0].positionField,g=a.newState,f=a.dropOptions,b=a.view.getStore(),e=b.masterStore;e.suspendAutoSync();Ext.Array.each(h,function(a){if(a.isValidTransition(g)){a.setState(g);c.push(a)}});if(c.length>0){b.remove(c);var l=f?b.indexOf(f.task)+(f.type=='before'?0:1):b.getCount();b.insert(l,c);for(var d=0;d<b.getCount();d++){b.getAt(d).set(j,d,{silent:!0})}b.sort()}e.resumeAutoSync(e.autoSync)}if(c.length===0){i.el.dom.style.display='block';i.el.animate({duration:500,easing:'ease-out',to:{x:a.repairXY[0],y:a.repairXY[1]},stopAnimation:!0})}else {this.fireEvent('taskdrop',this,a.taskRecords)}delete this.dropMode;this.fireEvent('aftertaskdrop',this,a.taskRecords);if(a.placeholder){Ext.fly(a.placeholder).remove()}return c.length>0}});Ext.define('Kanban.editor.Base',{triggerEvent:'taskdblclick',panel:null,selector:'.sch-task',editRecord:function(a,c){if(this.panel.isReadOnly()){return}var b=this.panel.getElementForTask(a);if(b){this.triggerEdit(a,c)}},triggerEdit:function(a,b){throw 'Abstract method call'},init:function(a){this.panel=a;if(this.triggerEvent){a.on(this.triggerEvent,function(d,a,c,b){this.editRecord(a,b)},this);a.on('taskkeydown',function(c,b,d,a){if(a.getKey()===a.ENTER&&a.getTarget().nodeName.toLowerCase()!=='input'){this.editRecord(b,a)}},this)}}});Ext.define('Kanban.editor.SimpleEditor',{extend:'Ext.Editor',mixins:['Kanban.editor.Base'],alias:'widget.kanban_simpleeditor',alignment:'tl',autoSize:{width:'boundEl'},selector:'.sch-task-name',dataIndex:'Name',field:{xtype:'textfield',minWidth:100,allowEmpty:!1},minWidth:100,initComponent:function(){var a=this;a.on('complete',a.onEditDone,a);a.callParent()},triggerEdit:function(b,e){var a=this.panel.getElementForTask(b);if(a){var d=this.panel.resolveViewByNode(a);var c=d.up('panel').zoomLevel;if(c!=='mini'){this.record=b;this.startEdit(a.down(this.selector))}}},onEditDone:function(){this.record.set(this.dataIndex,this.getValue())}});Ext.define('Kanban.field.AddNew',{extend:'Ext.form.TextField',alias:'widget.addnewfield',enableKeyEvents:!0,emptyText:'Add new task...',store:null,defaults:null,initComponent:function(){this.on('keyup',this.onMyKeyUp,this);if(Ext.isString(this.store)){this.store=Ext.getStore(this.store)}this.callParent(arguments)},onMyKeyUp:function(b,a){if(a.getKey()===a.ENTER){this.addTask()}},addTask:function(){var c={};var a=this.up('taskcolumn');c[this.store.model.prototype.nameField]=this.getValue();var e=this.store.add(Ext.apply(c,this.defaults))[0];this.reset();if(a){var d=a.down('taskview'),b=d.getNode(e);if(b){Ext.fly(b).scrollIntoView(d.el,!1,!0)}}}});Ext.define('Kanban.field.ColumnFilter',{extend:'Ext.form.ComboBox',alias:'widget.columnfilter',requires:['Ext.data.JsonStore'],multiSelect:!0,valueField:'id',displayField:'name',panel:null,queryMode:'local',listConfig:{htmlEncode:!0,cls:'sch-columnfilter-list'},initComponent:function(){var a=this;a.store=new Ext.data.JsonStore({proxy:'memory',fields:['id','name']});a.loadStore();a.callParent(arguments);a.getPicker().on({beforeshow:a.onBeforeColumnListShow,scope:a});a.getPicker().on({show:function(b){b.on('selectionchange',a.applyFilterToColumns,a)},hide:function(b){b.un('selectionchange',a.applyFilterToColumns,a)},delay:50,scope:a});a.value=a.value||a.panel.query('taskcolumn').map(function(a){return a.state});a.applyFilterToColumns()},loadStore:function(){var a=this,b=Sch.locale.Active['Kanban.locale']||{},c=a.panel.query('taskcolumn').map(function(a){return {id:a.state,name:a.origTitle||b[a.state]||a.state}});a.store.loadData(c)},applyFilterToColumns:function(){var a=this,b=a.value;a.store.each(function(c){var e=a.panel.down('[state='+c.get('id')+']'),d=Ext.Array.indexOf(b,c.get('id'))>=0;e[d?'show':'hide']()})},onBeforeColumnListShow:function(){var a=this,b=[];Ext.each(a.panel.query('taskcolumn'),function(c){if(c.isVisible()){b.push(a.store.getById(c.state))}});a.select(b)}});Ext.define('Kanban.field.TaskFilter',{extend:'Ext.form.TextField',alias:'widget.filterfield',requires:['Ext.util.Filter'],enableKeyEvents:!0,minLength:2,store:null,caseSensitive:!1,initComponent:function(){this.on('change',this.onMyChange,this);this.store=Ext.data.StoreManager.lookup(this.store);this.field=this.field||this.store.getModel().prototype.nameField;this.filter=this.filter||new Ext.util.Filter({id:this.getId()+'-filter',property:this.field,value:'',caseSensitive:this.caseSensitive,anyMatch:!0});this.callParent(arguments)},onMyChange:function(){var a=this.getValue();if(a&&a.length>=this.minLength){this.filter.setValue(a);this.store.addFilter(this.filter)}else {this.store.removeFilter(this.filter)}}});Ext.define('Kanban.field.TaskHighlight',{extend:'Ext.form.TextField',alias:'widget.highlightfield',mixins:['Ext.AbstractPlugin'],enableKeyEvents:!0,minLength:2,preventMark:!0,panel:null,field:'Name',caseSensitive:!1,initComponent:function(){this.on('keyup',this.onMyKeyUp,this);this.callParent(arguments)},onMyKeyUp:function(c,d){var a=this.getValue();if(a&&a.length>=this.minLength){var b=[];a=this.caseSensitive?a:a.toLowerCase();this.panel.highlightTasksBy(function(c){var b=this.caseSensitive?c.data[this.field]:c.data[this.field].toLowerCase();return b&&b.indexOf(a)>=0},this)}else {this.panel.clearHighlight()}}});Ext.define('Kanban.locale.En',{extend:'Sch.locale.Locale',singleton:!0,constructor:function(a){Ext.apply(this,{l10n:{'Kanban.menu.TaskMenuItems':{copy:'Duplicate',remove:'Delete',edit:'Edit',states:'Status',users:'Assign to'}},NotStarted:'Not Started',InProgress:'In Progress',Test:'Test',Done:'Done'});this.callParent(arguments)}});Ext.define('Kanban.menu.UserMenu',{extend:'Ext.menu.Menu',alias:'widget.kanban_usermenu',cls:'sch-usermenu',plain:!0,resourceStore:null,initComponent:function(){var a=this;Ext.apply(this,{renderTo:document.body,listeners:{beforeshow:function(){var a=this.task.getResource();if(a){this.items.each(function(b){if(a==b.user){b.addCls('sch-user-selected')}else {b.removeCls('sch-user-selected')}})}}}});this.resourceStore=Ext.data.StoreManager.lookup(this.resourceStore);this.mon(this.resourceStore,{load:this.populate,add:this.populate,remove:this.populate,update:this.populate,scope:this});this.callParent(arguments);this.populate()},showForTask:function(a,b){this.task=a;if(this.resourceStore.getCount()>0){this.showAt(b)}},onUserSelected:function(a){this.task.assign(a.user)},populate:function(){var b=this;var a=[];this.resourceStore.each(function(c){a.push({text:c.getName(),user:c,handler:b.onUserSelected,scope:b})});this.removeAll(!0);this.add(a)}});Ext.define('Kanban.menu.TaskMenuItems',{requires:['Kanban.editor.SimpleEditor','Kanban.menu.UserMenu'],mixins:['Sch.mixin.Localizable'],taskBoard:null,mainMenu:null,defaultActions:null,editorClass:null,editor:null,userMenuClass:null,userMenu:null,constructor:function(a){Ext.apply(this,a);this.mainMenu.on('beforeshow',this.onBeforeShow,this);this.items=this.items||[];if(this.defaultActions){this.initEditor();this.initUserMenu();this.initStateMenu();this.items=this.items.concat([{action:'edit',text:this.L('edit'),handler:this.onEditClick,scope:this},{action:'assign',text:this.L('users'),menu:this.userMenu},{action:'setState',text:this.L('states'),menu:this.stateMenu},{action:'copy',text:this.L('copy'),handler:this.onCopyClick,scope:this},{action:'remove',text:this.L('remove'),handler:this.onRemoveClick,scope:this}])}this.callParent(arguments)},onBeforeShow:function(b){var a=b.getTask();if(this.userMenu){this.userMenu.task=a}if(this.editor){this.editor.task=a}},getItems:function(){return this.items},initEditor:function(){if(!this.editor){if(this.taskBoard.getTaskEditor()){this.editor=this.taskBoard.getTaskEditor()}else {this.editor=Ext.create(this.editorClass,{dataIndex:this.taskBoard.taskStore.model.prototype.nameField,panel:this.taskBoard})}}},onEditClick:function(b,a){this.editor.editRecord(this.mainMenu.getTask(),a)},initUserMenu:function(){if(!this.userMenu){this.userMenu=Ext.create(this.userMenuClass,{resourceStore:this.taskBoard.resourceStore,onBodyClick:Ext.emptyFn})}},initStateMenu:function(){var a=this,b=this.taskBoard.taskStore.model,c=b.prototype.stateField,f=b.prototype.states;var e=Sch.locale.Active['Kanban.locale']||{};var g=Ext.Array.map(f,function(b){return {text:e[b]||b,state:b,handler:a.onStateClick,scope:a}});var d=a.mainMenu;this.stateMenu=new Ext.menu.Menu({items:g,plain:!0,listeners:{show:function(){var a=d.getTask();var b=a.get(c);this.items.each(function(c){c.setDisabled(c.state===b||!a.isValidTransition(c.state))})}}})},onStateClick:function(a){this.mainMenu.task.setState(a.state)},onCopyClick:function(d){var b=this.taskBoard.taskStore,c=this.mainMenu.getTask(),a=c.copy(null);a.setName(a.getName());b.add(a)},onRemoveClick:function(c){var a=this.taskBoard.taskStore,b=this.mainMenu.getTask();a.remove(b)}});Ext.define('Kanban.menu.TaskMenu',{extend:'Ext.menu.Menu',requires:['Kanban.menu.TaskMenuItems'],isTaskMenu:!0,alias:'widget.kanban_taskmenu',cls:'sch-task-menu',handleCls:'sch-task-menu-handle',taskBoard:null,config:{task:null},hideHandleTimer:null,handleHideDelay:500,currentHandle:null,editorClass:'Kanban.editor.SimpleEditor',userMenuClass:'Kanban.menu.UserMenu',defaultActions:!0,itemFactoryClass:'Kanban.menu.TaskMenuItems',initComponent:function(){this.on('beforeshow',this.onBeforeShow,this);if(this.defaultActions){this.items=Ext.create(this.itemFactoryClass,{editorClass:this.editorClass,userMenuClass:this.userMenuClass,defaultActions:this.defaultActions,items:this.items||[],taskBoard:this.taskBoard,mainMenu:this}).getItems()}this.callParent(arguments)},registerListeners:function(){this.mon(this.taskBoard.el,{click:this.onMenuHandleClick,delegate:'.'+this.handleCls,scope:this});this.mon(this.taskBoard,{taskmouseenter:this.onHandleMouseOver,taskmouseleave:this.onHandleMouseLeave,scope:this})},showForTask:function(a,c,d){var b=c.getTarget('.sch-task');this.setTask(a);this.show();this.alignTo(b,'tl-tr?')},onMenuHandleClick:function(b,a){var c=this.taskBoard.resolveRecordByNode(a);b.stopEvent();this.showForTask(c,b,a)},onHandleMouseOver:function(e,d,a,c,b){window.clearTimeout(this.hideHandleTimer);this.hide();this.currentHandle&&this.currentHandle.setVisible(!1);this.currentHandle=Ext.select('.'+this.handleCls,!1,a).setVisible(!0)},onHandleMouseLeave:function(e,d,a,c,b){this.hideHandleTimer=Ext.defer(function(){this.currentHandle&&this.currentHandle.setVisible(!1)},this.handleHideDelay,this)},shouldShowItem:function(a,b){return !0},onBeforeShow:function(b){var a=this.getTask();this.items.each(function(b){b.task=a;b.setVisible(this.shouldShowItem(b,a))},this)},destroy:function(){clearTimeout(this.hideHandleTimer);this.callParent(arguments)}});Ext.define('Kanban.menu.UserPicker',{extend:'Ext.view.View',alias:['widget.userpicker','widget.kanban_userpicker'],cls:'sch-userpicture-view',autoScroll:!0,showName:!0,padding:'10 5 5 5',itemSelector:'.sch-user',overItemCls:'sch-user-hover',selectedItemCls:'sch-user-selected',initComponent:function(){var a=this.store&&this.store.model&&this.store.model.prototype;var c=a&&a.nameField||'Name';var b=a&&a.imageUrlField||'ImageUrl';Ext.apply(this,{itemTpl:'<tpl for=".">'+'<div class="sch-user">'+'<img src="{'+b+':htmlEncode}" />'+(this.showName?'<span>{'+c+':htmlEncode}</span>':'')+'</div>'+'</tpl>'});this.callParent(arguments)}});Ext.define('Kanban.menu.UserPictureMenu',{extend:'Ext.menu.Menu',alias:['widget.userpicturemenu','widget.kanban_userpicturemenu'],requires:['Kanban.menu.UserPicker'],cls:'sch-userpicturemenu',width:290,height:200,resourceStore:null,hideOnSelect:!0,initComponent:function(){var a=this,b=Ext.apply({},a.initialConfig);delete b.listeners;Ext.apply(a,{plain:!0,showSeparator:!1,bodyPadding:0,items:Ext.applyIf({margin:0,store:this.resourceStore,xtype:'userpicker'},b)});a.callParent(arguments);a.picker=a.down('userpicker');a.relayEvents(a.picker,['select']);if(a.hideOnSelect){a.on('select',a.onUserSelected,a)}this.mon(Ext.getBody(),'click',this.onBodyClick,this)},showForTask:function(a,c){this.task=a;this.showAt(c);var b=a.getResource();if(b){this.picker.select(b,!1,!0)}else {this.picker.getSelectionModel().deselectAll()}},onUserSelected:function(b,a){this.hide();this.task.assign(a)},onBodyClick:function(a,b){if(!a.within(this.el)){this.hide()}}});Ext.define('Kanban.selection.TaskModel',{extend:'Ext.mixin.Observable',panel:null,selModels:null,constructor:function(b){var a=this;Ext.apply(a,b);a.callParent(arguments);a.selModels=Ext.Array.map(a.panel.views,function(a){return a.getSelectionModel()});a.forEachView(function(b){a.mon(b,'containerclick',a.onEmptyAreaClick,a);a.relayEvents(b,['select','deselect']);a.relayEvents(b.getSelectionModel(),['selectionchange'])})},select:function(a,e,d){a=[].concat(a);var c=!1;var b=function(){c=!0};this.forEachSelModel(function(c){var f=Ext.Array.filter(a,function(a){return c.store.indexOf(a)>=0});c.on('selectionchange',b,null,{single:!0});if(f.length>0){c.select(f,e,d)}else {c.deselectAll()}c.un('selectionchange',b,null,{single:!0})});if(c){this.fireEvent('selectionchange',this.getSelection())}},deselect:function(a,b){a=[].concat(a);this.forEachSelModel(function(c){var d=Ext.Array.filter(a,function(a){return c.store.indexOf(a)>=0});c.deselect(d,b)});this.fireEvent('selectionchange',this.getSelection())},selectAll:function(){this.relayMethod('selectAll')},deselectAll:function(){this.relayMethod('deselectAll')},getSelection:function(){return this.relayMethod('getSelection')},getCount:function(){return Ext.Array.sum(this.relayMethod('getCount'))},deselectAllInOtherSelectionModels:function(a){this.forEachSelModel(function(b){b!==a&&b.deselectAll()})},relayMethod:function(a,b){return [].concat.apply([],Ext.Array.map(this.selModels,function(c){return c[a].apply(c,b||[])}))},forEachSelModel:function(b,a){Ext.Array.each(this.selModels,b,a||this)},onEmptyAreaClick:function(){this.deselectAll()},forEachView:function(b,a){Ext.Array.each(this.panel.views,b,a||this)},destroy:function(){}});Ext.define('Kanban.template.Task',{extend:'Ext.XTemplate',model:null,menuIconTpl:'<div class="sch-task-menu-handle x-fa fa-gear"></div>',constructor:function(b){var a=this;b=b||{};b.menuIconTpl=b.menuIconTpl!==undefined?b.menuIconTpl:a.menuIconTpl;Ext.apply(a,b);var c=a.model.prototype;var d=c.idProperty;var e=c.nameField;if(typeof a.taskBodyTpl!=='string'){a.taskBodyTpl='<tpl if="'+c.imageUrlField+'"><img class="sch-task-img" src="{taskImageUrl:htmlEncode}"/></tpl>'+'<span class="sch-task-id">{[ values.'+d+' ? "#" + values.'+d+' : "" ]}</span><span class="sch-task-name"> {'+e+':htmlEncode}</span>'}if(typeof a.resourceImgTpl!=='string'){a.resourceImgTpl='<img src="{resourceImageUrl:htmlEncode}" class="sch-user-avatar {resourceImageCls:htmlEncode}" />'}a.callParent(['<tpl for=".">','<div class="sch-task sch-task-state-{[Ext.String.htmlEncode(values.'+c.stateField+".replace(/\\s/g, '-'))]} {"+c.clsField+':htmlEncode} {cls:htmlEncode} x-unselectable" unselectable="on" style="{style}">'+'<div class="sch-task-inner">'+a.taskBodyTpl+a.resourceImgTpl+(a.taskToolTpl||'')+'</div>'+a.menuIconTpl+'</div>'+'</tpl>'])}});Ext.define('Kanban.view.TaskView',{extend:'Ext.view.View',alias:'widget.taskview',requires:['Kanban.template.Task','Kanban.data.ViewStore'],autoScroll:!0,trackOver:!0,overItemCls:'sch-task-over',selectedItemCls:'sch-task-selected',itemSelector:'.sch-task',state:null,taskRenderer:function(b,a){},initComponent:function(){var a=this;if(a.store&&a.store.model){a.tpl=new Kanban.template.Task({model:a.store.model,resourceImgTpl:a.resourceImgTpl,taskToolTpl:a.taskToolTpl,taskBodyTpl:a.taskBodyTpl,menuIconTpl:a.menuIconTpl})}else {a.tpl=new Ext.XTemplate('')}a.addCls('sch-taskview sch-taskview-state-'+a.state.replace(/\s/g,'-'));a.callParent(arguments)},bindStore:function(a){if(a&&a.model){this.tpl=new Kanban.template.Task({model:a.model,resourceImgTpl:this.resourceImgTpl,taskToolTpl:this.taskToolTpl,taskBodyTpl:this.taskBodyTpl,menuIconTpl:this.menuIconTpl})}this.callParent(arguments)},refresh:function(){var b=this.getEl();var a=b.down('.'+Ext.baseCSSPrefix+'view-selector');if(a){b.removeChild(a)}this.callParent(arguments);if(a){b.appendChild(a)}},collectData:function(h){var e=this.callParent(arguments),f=[];for(var c=0;c<e.length;c++){var a=Ext.apply({},e[c]);var b=h[c];var g=b.getResource();var d=g&&g.getImageUrl();a.resourceImageCls='';a.resourceImageUrl=d||Ext.BLANK_IMAGE_URL;a.taskImageUrl=b.getImageUrl();a.task=b;a.name=b.getName();if(!d){a.resourceImageCls='sch-no-img'}this.taskRenderer(b,a);if(b.phantom){a.cls=(a.cls||'')+' sch-phantom-task'}f.push(a)}return f}});Ext.define('Kanban.view.TaskColumn',{extend:'Ext.Panel',alias:'widget.taskcolumn',requires:['Ext.layout.container.Fit','Kanban.view.TaskView'],flex:1,layout:'fit',collapseDirection:'right',state:null,store:null,taskBodyTpl:null,taskToolTpl:null,resourceImgTpl:null,origTitle:null,view:null,zoomLevel:'large',viewConfig:null,initComponent:function(){var a=this;if(a.state===null){throw 'Must supply state'}var b=Ext.apply({state:a.state},a.viewConfig||{});if(a.taskBodyTpl){b.taskBodyTpl=a.taskBodyTpl}if(a.taskToolTpl){b.taskToolTpl=a.taskToolTpl}if(a.resourceImgTpl){b.resourceImgTpl=a.resourceImgTpl}a.items=a.view=new Kanban.view.TaskView(b);var c=Sch.locale.Active['Kanban.locale']||{};a.origTitle=a.title=a.title||c[a.state]||a.state;a.callParent(arguments);a.addCls('sch-taskcolumn sch-taskcolumn-state-'+a.state.replace(/\s/g,'-'))},onRender:function(){this.setZoomLevel(this.zoomLevel);if(this.header){this.header.addCls('sch-taskcolumnheader-state-'+this.state.replace(/\s/g,'-'))}this.callParent(arguments)},refreshTitle:function(){var b=this.state;var a=this.store.query(this.store.getModel().prototype.stateField,b,!1,!1,!0).length;this.setTitle(this.origTitle+(a?' ('+a+')':''))},bindStore:function(a){var b={load:this.refreshTitle,datachanged:this.refreshTitle,update:this.refreshTitle,add:this.refreshTitle,remove:this.refreshTitle,buffer:20,scope:this};if(this.store){this.store.unbindFromStore();this.mun(this.store,b)}if(a){this.mon(a,b);this.view.bindStore(a)}this.store=a;this.refreshTitle()},getZoomLevel:function(){return this.zoomLevel},setZoomLevel:function(a){this.zoomLevel=a||'large';this.el.set({size:a})}});Ext.define('Kanban.view.TaskBoard',{extend:'Ext.Panel',alias:'widget.taskboard',requires:['Sch.patches.View','Kanban.patch.EXTJS_23846','Kanban.locale.En','Kanban.data.TaskStore','Kanban.data.ResourceStore','Kanban.view.TaskColumn','Kanban.dd.DropZone','Kanban.dd.DragZone','Kanban.editor.SimpleEditor','Kanban.field.AddNew','Kanban.menu.UserMenu','Kanban.menu.TaskMenu','Kanban.selection.TaskModel'],border:!1,layout:{type:'hbox',align:'stretch'},defaultType:'taskcolumn',config:{taskStore:null,resourceStore:{type:'kanban_resourcestore'}},fitColumns:!0,dragZoneConfig:null,dropZoneConfig:null,columnClass:'Kanban.view.TaskColumn',columns:null,columnConfigs:null,editor:null,viewConfig:null,enableUserMenu:!0,readOnly:!1,userMenu:null,taskMenu:!0,dndValidatorFn:Ext.emptyFn,validatorFnScope:null,zoomLevel:'large',destroyStores:!1,enableClipboard:!1,taskCls:'sch-task',taskSelector:'.sch-task',isHighlighting:!1,views:null,kanbanColumns:null,selModel:null,clipboard:null,initComponent:function(){var a=this;a.defaults=a.defaults||{};Ext.applyIf(a.defaults,{margin:12});a.taskStore=Ext.data.StoreManager.lookup(a.taskStore);a.resourceStore=Ext.data.StoreManager.lookup(a.resourceStore);a.addCls('sch-taskboard');a.addBodyCls('sch-taskboard-body');if(!a.fitColumns){a.addCls('sch-taskboard-scrollable');a.setScrollable('x');a.setLayout('auto')}var b=a.getConfig('bind');if(b){if(b.taskStore){a.taskStore=new Kanban.data.TaskStore()}if(b.resourceStore){a.resourceStore=new Kanban.data.ResourceStore()}}a.taskStore=Ext.data.StoreManager.lookup(a.taskStore);a.resourceStore=Ext.data.StoreManager.lookup(a.resourceStore);a.on({add:a.onColumnsAdded,remove:a.onColumnsRemoved,scope:a});if(!a.columns){a.columns=a.createColumns()}else {a.columns=Ext.clone(a.columns);a.initColumns(a.columns)}a.items=a.columns;if(!a.taskStore){throw 'Must define a taskStore for the Panel'}if(!a.resourceStore){throw 'Must define a resourceStore for the Panel'}a.callParent(arguments);a.bindResourceStore(a.resourceStore,!0)},setTaskStore:function(a){this.taskStore=Ext.StoreManager.lookup(a);this.taskStore.setResourceStore(this.getResourceStore());this.rendered&&this.forEachColumn(function(a){a.bindStore(new Kanban.data.ViewStore({masterStore:this.taskStore,state:a.state}))})},setResourceStore:function(a){this.bindResourceStore(a)},createColumns:function(){var a=this;var c=a.taskStore.model.prototype.states;var b=a.columnConfigs||{};return Ext.Array.map(c,function(c,d){return Ext.create(a.columnClass,Ext.apply({state:c,viewConfig:a.viewConfig,zoomLevel:a.zoomLevel,layout:a.fitColumns?'fit':'auto',manageHeight:!a.fitColumns},Ext.apply(b[c]||{},b.all)))})},initColumns:function(b){var a=this;Ext.Array.forEach(b,function(b){if(b.items){a.initColumns(b.items)}else {Ext.applyIf(b,{viewConfig:a.viewConfig})}},this)},onColumnsAdded:function(c,a){var b=a instanceof Kanban.view.TaskColumn?[a]:a.query('taskcolumn');Ext.Array.forEach(b,function(a){a.bindStore(new Kanban.data.ViewStore({masterStore:this.taskStore,state:a.state}));this.bindViewListeners(a.view);this.kanbanColumns&&this.kanbanColumns.push(a);this.views&&this.views.push(a.view)},this)},onColumnsRemoved:function(c,a){var b=a instanceof Kanban.view.TaskColumn&&a;Ext.Array.remove(this.kanbanColumns,b);Ext.Array.remove(this.views,b.view)},afterRender:function(){this.callParent(arguments);if(!this.isReadOnly()){this.setupDragDrop();this.initEditor();this.initTaskMenu();if(this.enableUserMenu&&this.userMenu){this.initUserMenu()}}this.views=this.query('taskview');this.kanbanColumns=this.query('taskcolumn');this.on('taskclick',this.onTaskClick,this);if(this.enableClipboard){this.getEl().on({keydown:this.onKeyDown,scope:this})}},onKeyDown:function(b){var a=this;if(!b.ctrlKey){return}switch(b.browserEvent.key.toLowerCase()){case 'c':a.copyTasksToClipboard();break;case 'v':a.pasteTasks();break;case 'x':a.cutTasksToClipboard();break;}},copyTasksToClipboard:function(){var a=this;a.clipboard=a.getSelectedRecords();a.clipboard.copy=!0},cutTasksToClipboard:function(){var a=this;a.clipboard=a.getSelectedRecords();a.clipboard.copy=!1;a.clipboard.forEach(function(c){var b=a.getElementForTask(c);b&&b.addCls('sch-taskboard-cut-task')})},pasteTasks:function(){var a=this;var b=a.resolveState(document.activeElement);if(a.clipboard&&b!==!1){a.clipboard.forEach(function(c){c=a.clipboard.copy?c.copy(null):c;c.setState(b);if(a.clipboard.copy){a.taskStore.add(c)}var d=a.getElementForTask(c);d&&d.removeCls('sch-taskboard-cut-task')})}},setReadOnly:function(a){this.readOnly=a},isReadOnly:function(){return this.readOnly},bindViewListeners:function(a){a.on({itemclick:this.getTaskListener('taskclick'),itemcontextmenu:this.getTaskListener('taskcontextmenu'),itemdblclick:this.getTaskListener('taskdblclick'),itemmouseenter:this.getTaskListener('taskmouseenter'),itemmouseleave:this.getTaskListener('taskmouseleave'),itemkeydown:this.getTaskListener('taskkeydown'),itemkeyup:this.getTaskListener('taskkeyup'),scope:this})},setupDragDrop:function(){var a=this;var b='kanban-dd-'+a.id,c=a.el;a.dragZone=new Kanban.dd.DragZone(a.body.id,Ext.apply({panel:a,containerScroll:!a.fitColumns,ddGroup:b},a.dragZoneConfig));a.dropZone=new Kanban.dd.DropZone(a.body.id,Ext.apply({panel:a,validatorFn:a.dndValidatorFn,validatorFnScope:a.validatorFnScope,ddGroup:b},a.dropZoneConfig));a.relayEvents(a.dragZone,['beforetaskdrag','taskdragstart','aftertaskdrop']);this.relayEvents(this.dropZone,['beforetaskdropfinalize','taskdrop','aftertaskdrop']);this.dropZone.on('aftertaskdrop',this.onAfterTaskDrop,this);this.dragZone.on('taskdragstarting',this.onDragStarting,this)},resolveState:function(b){if(Ext.isIE&&!b){b=document.body}if(!b.dom){var a=Ext.fly(b);if(!a.is('.sch-taskview')){a=a.up('.sch-taskview')}if(a&&a.component){return a.component.state}}return !1},setZoomLevel:function(a){this.translateToColumns('setZoomLevel',[a])},getZoomLevel:function(){return this.down('taskcolumn').getZoomLevel()},initEditor:function(){if(this.editor){if(!this.editor.isComponent){this.editor=Ext.widget(this.editor)}this.editor.init(this)}},initUserMenu:function(){if(!(this.userMenu instanceof Ext.Component)){this.userMenu=Ext.ComponentManager.create(this.userMenu)}this.el.on({click:this.onUserImgClick,delegate:'.sch-user-avatar',scope:this})},initTaskMenu:function(){if(this.taskMenu){var a=typeof this.taskMenu==='boolean'?{xtype:'kanban_taskmenu'}:this.taskMenu;if(Ext.isArray(a)){a={items:a}}a.taskBoard=this;if(!a.isTaskMenu){this.taskMenu=Ext.widget(Ext.applyIf(a,{xtype:'kanban_taskmenu'}))}this.taskMenu.registerListeners();this.addCls('sch-taskboard-with-menu')}},onUserImgClick:function(a,b){a.stopEvent();if(!this.isReadOnly()){this.userMenu.showForTask(this.resolveRecordByNode(b),a.getXY())}},resolveViewByNode:function(b){var a=Ext.fly(b).up('.sch-taskview');return a&&Ext.getCmp(a.id)||null},resolveRecordByNode:function(b){var a=this.resolveViewByNode(b);return a&&a.getRecord(a.findItemByChild(b))||null},onTaskClick:function(b,c,d,a){if(!a.ctrlKey){this.deselectAllInOtherViews(b)}},deselectAllInOtherViews:function(a){this.getSelectionModel().deselectAllInOtherSelectionModels(a.getSelectionModel())},getElementForTask:function(a){if(!(a instanceof Ext.data.Model)){a=this.taskStore.getById(a)}var b=a.getState();if(b){return Ext.get(this.getViewForState(b).getNode(a))}},getViewForState:function(a){return this.down('taskview[state='+[a]+']')},forEachColumn:function(b,a){Ext.Array.each(this.query('taskcolumn'),b,a||this)},translateToViews:function(a,b){Ext.Array.map(this.views,function(c){return c[a].apply(c,b||[])})},translateToColumns:function(a,b){Ext.Array.map(this.kanbanColumns,function(c){return c[a].apply(c,b||[])})},translateToSelectionModels:function(a,b){Ext.Array.map(this.views,function(d){var c=d.getSelectionModel();c[a].apply(c,b||[])})},getSelectedRecords:function(){return [].concat.apply([],Ext.Array.map(this.views,function(a){return a.getSelectionModel().getSelection()}))},selectAll:function(){this.getSelectionModel().selectAll()},deselectAll:function(){this.getSelectionModel().deselectAll()},onDestroy:function(){Ext.destroy(this.dragZone,this.dropZone,this.userMenu,this.taskMenu,this.editor);this.clipboard=null;if(this.destroyStores){this.taskStore.destroy();this.resourceStore.destroy()}},getTaskListener:function(a){return function(e,b,d,f,c){this.fireEvent(a,e,b,d,c)}},highlightTasksBy:function(d,e){if(!this.isHighlighting){this.el.addCls('sch-taskboard-filtered');this.isHighlighting=!0}this.el.select('.sch-filter-match').removeCls('sch-filter-match');for(var a=0,f=this.taskStore.getCount();a<f;a++){var b=this.taskStore.getAt(a);if(d.call(e||this,b)){var c=this.getElementForTask(b);if(c){c.addCls('sch-filter-match')}}}},clearHighlight:function(){this.isHighlighting=!1;this.el.removeCls('sch-taskboard-filtered');this.el.select('.sch-filter-match').removeCls('sch-filter-match')},refresh:function(){this.translateToViews('refresh');this.fireEvent('refresh',this)},refreshTaskNode:function(b){var a=this.getElementForTask(b);if(a){var c=this.resolveViewByNode(a);c.refreshNode(b)}},bindResourceStore:function(a,c){var b={update:this.onResourceStoreUpdate,refresh:this.onResourceStoreRefresh,remove:this.onResourceStoreRemove,scope:this};if(this.resourceStore){this.mun(this.resourceStore,b)}if(a){a=Ext.data.StoreManager.lookup(a);this.mon(a,b);this.taskStore&&this.taskStore.setResourceStore(a);if(!c&&this.rendered){this.refresh()}}this.resourceStore=a},onResourceStoreUpdate:function(){if(this.rendered){this.refresh()}},onResourceStoreRefresh:function(){if(this.rendered){this.refresh()}},onResourceStoreRemove:function(){if(this.rendered){this.refresh()}},onDragStarting:function(d,a,b){var c=this.getViewForState(a.getState());if(!b.ctrlKey){this.deselectAll()}},onAfterTaskDrop:function(){this.getSelectionModel().deselectAll()},getTaskMenu:function(){return this.taskMenu},getTaskStore:function(){return this.taskStore},getResourceStore:function(){return this.resourceStore},getTaskEditor:function(){return this.editor},getSelectionModel:function(){if(!this.selModel){this.selModel=this.createSelectionModel()}return this.selModel},createSelectionModel:function(){var a=new Kanban.selection.TaskModel({panel:this});this.relayEvents(a,['deselect','select']);return a}},function(){Ext.apply(Kanban,{VERSION:'2.0.30',LICENSE:'%LICENSE%'})});